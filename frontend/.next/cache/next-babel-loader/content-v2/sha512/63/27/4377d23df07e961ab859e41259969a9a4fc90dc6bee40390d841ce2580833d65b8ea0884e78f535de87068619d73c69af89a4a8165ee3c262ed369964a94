{"ast":null,"code":"\"use strict\";\n\nvar _regeneratorRuntime = require(\"/Users/austin/Desktop/bbgo/frontend/node_modules/next/node_modules/@babel/runtime/regenerator\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _router = _interopRequireDefault(require(\"next/router\"));\n\nvar _onDemandEntriesUtils = require(\"./on-demand-entries-utils\");\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nfunction _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar _default = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(_ref) {\n  var _this = this;\n\n  var assetPrefix;\n  return _regeneratorRuntime.wrap(function _callee$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          assetPrefix = _ref.assetPrefix;\n\n          _router[\"default\"].ready(function () {\n            _router[\"default\"].events.on('routeChangeComplete', _onDemandEntriesUtils.setupPing.bind(_this, assetPrefix, function () {\n              return _router[\"default\"].pathname;\n            }));\n          });\n\n          (0, _onDemandEntriesUtils).setupPing(assetPrefix, function () {\n            return _router[\"default\"].query.__NEXT_PAGE || _router[\"default\"].pathname;\n          }, _onDemandEntriesUtils.currentPage); // prevent HMR connection from being closed when running tests\n\n          if (!process.env.__NEXT_TEST_MODE) {\n            document.addEventListener('visibilitychange', function (_event) {\n              var state = document.visibilityState;\n\n              if (state === 'visible') {\n                (0, _onDemandEntriesUtils).setupPing(assetPrefix, function () {\n                  return _router[\"default\"].pathname;\n                }, true);\n              } else {\n                (0, _onDemandEntriesUtils).closePing();\n              }\n            });\n            window.addEventListener('beforeunload', function () {\n              (0, _onDemandEntriesUtils).closePing();\n            });\n          }\n\n        case 4:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, _callee);\n}).bind(void 0)).bind(void 0);\n\nexports[\"default\"] = _default;","map":{"version":3,"sources":["../../../client/dev/on-demand-entries-client.js"],"names":[],"mappings":";;;;;;;;;AAAmB,IAAA,OAAa,GAAA,sBAAA,CAAA,OAAA,CAAA,aAAA,CAAA,CAAb;;AAC+B,IAAA,qBAA2B,GAAA,OAAA,CAAA,2BAAA,CAA3B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAE1B,UAAA,W,QAAA,W;;AAHL,UAAA,OAAa,WAAb,CAIV,KAJU,CAIL,YAAO;AAJF,YAAA,OAAa,WAAb,CAKR,MALQ,CAKD,EALC,CAKC,qBALD,EAC+B,qBAA2B,CAAA,SAA3B,CAMlC,IANkC,CAM9B,KAN8B,EAMvB,WANuB,EAMZ;AAAA,qBAPnB,OAAa,WAAb,CAOkC,QAAf;AAAA,aANY,CAD/B;AAShB,WATgB;;cAC+B,qB,EAA2B,S,CAWzE,W,EAAW;AAAA,mBAZI,OAAa,WAAb,CAaF,KAbE,CAaI,WAbJ,IAAA,OAAa,WAAb,CAa0B,QAD9B;AAAA,W,EAXmC,qBAA2B,CAAA,W,GAgB3E;;AACA,cAAE,CAAG,OAAO,CAAC,GAAR,CAAY,gBAAjB,EAAmC;AACjC,YAAA,QAAQ,CAAC,gBAAT,CAAyB,kBAAzB,EAA4C,UAAG,MAAH,EAAc;AACxD,kBAAM,KAAK,GAAG,QAAQ,CAAC,eAAvB;;AACA,kBAAI,KAAK,KAAA,SAAT,EAAyB;oBApBmB,qB,EAA2B,S,CAqB3D,W,EAAW;AAAA,yBAtBV,OAAa,WAAb,CAsByB,QAAf;AAAA,iB,EAAyB,I;AAC/C,eAFD,MAEO;oBAtBqC,qB,EAA2B,S;AAwBtE;AACF,aAPD;AASA,YAAA,MAAM,CAAC,gBAAP,CAAuB,cAAvB,EAAsC,YAAQ;kBA3BA,qB,EAA2B,S;AA6BxE,aAFD;AAGD;;;;;;;;GACF,I,CAAA,KAAA,C,GAAA,I,CAAA,KAAA,C","sourcesContent":["import Router from 'next/router'\nimport { setupPing, currentPage, closePing } from './on-demand-entries-utils'\n\nexport default async ({ assetPrefix }) => {\n  Router.ready(() => {\n    Router.events.on(\n      'routeChangeComplete',\n      setupPing.bind(this, assetPrefix, () => Router.pathname)\n    )\n  })\n\n  setupPing(\n    assetPrefix,\n    () => Router.query.__NEXT_PAGE || Router.pathname,\n    currentPage\n  )\n\n  // prevent HMR connection from being closed when running tests\n  if (!process.env.__NEXT_TEST_MODE) {\n    document.addEventListener('visibilitychange', (_event) => {\n      const state = document.visibilityState\n      if (state === 'visible') {\n        setupPing(assetPrefix, () => Router.pathname, true)\n      } else {\n        closePing()\n      }\n    })\n\n    window.addEventListener('beforeunload', () => {\n      closePing()\n    })\n  }\n}\n"]},"metadata":{},"sourceType":"script"}